<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<title>Random Team Generator</title>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
		<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>
		<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
		<link rel="icon" href="img/logo.png" type="image/png">
		<style>
			body {
			font-family: 'Poppins', sans-serif;
			background-image: url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80');
			background-size: cover;
			background-position: center;
			height: 100vh;
			margin: 0;
			}
			.overlay {
			backdrop-filter: blur(8px);
			background-color: rgba(24, 66, 3, 0.4);
			height: 100vh;
			width: 100vw;
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
			padding: 1rem;
			}
			.loader {
			border: 8px solid #f3f3f3;
			border-top: 8px solid #0d6efd;
			border-radius: 50%;
			width: 50px;
			height: 50px;
			animation: spin 1s linear infinite;
			margin: 20px auto;
			display: none;
			}
			@keyframes spin {
			0% { transform: rotate(0deg); }
			100% { transform: rotate(360deg); }
			}
			.team-card {
			transition: transform 0.3s ease-in-out;
			}
			.team-card:hover {
			transform: scale(1.05);
			}
			.card-title {
			font-size: 1.5rem;
			}
			footer {
			background-color: rgba(12, 83, 32, 0.635);
			color: #fff;
			text-align: center;
			padding: 12px 0;
			position: fixed;
			bottom: 0;
			width: 100%;
			}
		</style>
	</head>
	<body>
		<div class="overlay">
			<div class="container text-center">
				<div id="startButtonContainer">
                    <h1 class="text-white mb-5" style="font-size: 1.93rem;background-color:  rgba(12, 83, 32, 0.9); padding: 25px; border-radius: 30px;">Random Team Generator</h1>
					<button id="startButton" class="btn btn-success btn-lg shadow" title="Mulai Buat Tim">
					<i class="bi bi-play-fill fs-2"></i>Mulai
					</button>
				</div>
				<div id="loader" class="loader"></div>
				<div id="result" class="d-none mt-4 row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4"></div>
				<div id="actionButtons" class="d-none mt-4 d-flex justify-content-center gap-3 flex-wrap">
					<button id="printButton" class="btn btn-success px-4 py-2 fw-semibold rounded-pill" title="Ok, Cetak"><i class="bi bi-printer"></i></button>
					<button id="reshuffleButton" class="btn btn-warning px-4 py-2 fw-semibold rounded-pill" title="Ulang Acak"><i class="bi bi-shuffle"></i></button>
					<button id="resetButton" class="btn btn-danger px-4 py-2 fw-semibold rounded-pill" title="Input Ulang Jumlah Tim"><i class="bi bi-arrow-repeat"></i></button>
				</div>
			</div>
		</div>
		<footer>Powered by D.A.M.Z</footer>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" 
			integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
		<script>
			function setBackgroundByOrientation() {
			  const portraitImg = 'https://images.unsplash.com/photo-1549896869-ca27eeffe4fb?q=80&w=387&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D';  // Potrait
			  const landscapeImg = 'https://images.unsplash.com/photo-1474546652694-a33dd8161d66?q=80&w=884&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; // Landscape
			
			  const isPortrait = window.matchMedia("(orientation: portrait)").matches;
			
			  document.body.style.backgroundImage = `url('${isPortrait ? portraitImg : landscapeImg}')`;
			}
			
			// Jalankan saat halaman dimuat
			window.addEventListener('load', setBackgroundByOrientation);
			// Jalankan ulang saat orientasi berubah (misal user rotate HP)
			window.addEventListener('resize', setBackgroundByOrientation);
		</script>
		<script>
			const startButtonContainer = document.getElementById('startButtonContainer');
			const startButton = document.getElementById('startButton');
			const resultDiv = document.getElementById('result');
			const actionButtons = document.getElementById('actionButtons');
			const printButton = document.getElementById('printButton');
			const reshuffleButton = document.getElementById('reshuffleButton');
			const resetButton = document.getElementById('resetButton');
			const loader = document.getElementById('loader');
			let teamCount = 0;
			let members = [];
			
			function shuffleArray(array) {
			for (let i = array.length - 1; i > 0; i--) {
			    const j = Math.floor(Math.random() * (i + 1));
			    [array[i], array[j]] = [array[j], array[i]];
			}
			return array;
			}
			
			function displayTeams() {
  resultDiv.innerHTML = '';
  const shuffledMembers = shuffleArray([...members]);
  
  // Inisialisasi array tim kosong
  const teams = Array.from({ length: teamCount }, () => []);

  // Distribusi anggota secara round-robin
  shuffledMembers.forEach((member, index) => {
    const teamIndex = index % teamCount;
    teams[teamIndex].push(member);
  });

  // Tampilkan setiap tim dalam kartu
  teams.forEach((teamMembers, i) => {
    const teamCard = document.createElement('div');
    teamCard.className = 'team-card col d-flex justify-content-center align-items-center';
    
    teamCard.innerHTML = `
    <div class="card bg-light bg-opacity-90 shadow-lg w-100" style="max-width: 400px;">
        <div class="card-body">
          <h3 style="background-color: rgba(12, 83, 32, 0.9); padding:3px" class="card-title text-white fw-bold mb-3">Tim ${i + 1}</h3>
          <ul class="list-group list-group-flush">
            ${teamMembers.map(member => `<li class="list-group-item">${member}</li>`).join('')}
          </ul>
        </div>
      </div>
    `;
    resultDiv.appendChild(teamCard);
  });

  resultDiv.classList.remove('d-none');
  actionButtons.classList.remove('d-none');
  loader.style.display = 'none';
}

			startButton.addEventListener('click', () => {
			Swal.fire({
			 title: 'Jumlah Tim',
			 input: 'number',
			 inputLabel: 'Masukkan jumlah tim',
			 inputAttributes: {
			   min: 1,
			   step: 1,
			   placeholder: 'Contoh: 2',
			   maxlength: 2
			 },
			 showCancelButton: true,
			 confirmButtonText: 'Lanjut',
			 cancelButtonText: 'Batal',
			 allowOutsideClick: false,
			 allowEscapeKey: false,
			 allowEnterKey: false,
			 inputValidator: (value) => {
			   if (!value || value < 1) {
			     return 'Masukkan jumlah tim yang valid!';
			   }
			 }
			}).then((result) => {
			 if (result.isConfirmed) {
			   teamCount = parseInt(result.value);
			   startButtonContainer.classList.add('d-none');
			
			   Swal.fire({
			     title: 'Masukkan Nama Anggota',
			     input: 'textarea',
			     inputLabel: 'Masukkan nama anggota (satu per baris)',
			     inputPlaceholder: 'Nama1\nNama2\nNama3\n...',
			     inputAttributes: {
			       maxlength: 1000
			     },
			     showCancelButton: true,
			     confirmButtonText: 'Buat Tim',
			     cancelButtonText: 'Batal',
			     allowOutsideClick: false,
			     allowEscapeKey: false,
			     allowEnterKey: false,
			     inputValidator: (value) => {
			       if (!value.trim()) {
			         return 'Masukkan setidaknya satu nama!';
			       }
			     }
			   }).then((result) => {
			     if (result.isConfirmed) {
			       members = result.value
			         .split('\n')
			         .map(name => name.trim())
			         .filter(name => name);
			
			      if (members.length < teamCount) {
			Swal.fire({
			 icon: 'error',
			 title: 'Jumlah anggota tidak cukup',
			 text: 'Jumlah anggota harus lebih banyak atau sama dengan jumlah tim!',
			 confirmButtonText: 'Perbaiki'
			}).then(() => {
			 // Tampilkan kembali input nama
			 Swal.fire({
			   title: 'Masukkan Nama Anggota',
			   input: 'textarea',
			   inputLabel: 'Masukkan nama anggota (satu per baris)',
			   inputPlaceholder: 'Nama1\nNama2\nNama3\n...',
			   inputAttributes: {
			     maxlength: 1000
			   },
			   inputValue: members.join('\n'), // isi kembali input sebelumnya
			   showCancelButton: true,
			   confirmButtonText: 'Buat Tim',
			   cancelButtonText: 'Batal',
			   allowOutsideClick: false,
			   allowEscapeKey: false,
			   allowEnterKey: false,
			   inputValidator: (value) => {
			     if (!value.trim()) {
			       return 'Masukkan setidaknya satu nama!';
			     }
			   }
			 }).then((result) => {
			   if (result.isConfirmed) {
			     members = result.value
			       .split('\n')
			       .map(name => name.trim())
			       .filter(name => name);
			
			     if (members.length < teamCount) {
			       // ✅ Rekursif: panggil diri sendiri lagi
			       Swal.fire('Error', 'Jumlah anggota masih kurang dari jumlah tim.', 'error').then(() => {
			         startButton.click(); // atau kamu bisa panggil fungsi tertentu jika tidak pakai button
			       });
			     } else {
			       loader.style.display = 'block';
			       setTimeout(displayTeams, 1000);
			     }
			   } else {
			     startButtonContainer.classList.remove('d-none');
			   }
			 });
			});
			return;
			}
			
			
			       loader.style.display = 'block';
			       setTimeout(displayTeams, 1000);
			     } else if (result.isDismissed) {
			       // ⬅️ Tampilkan kembali tombol jika user klik "Batal"
			       startButtonContainer.classList.remove('d-none');
			     }
			   }).catch(() => {
			     startButtonContainer.classList.remove('d-none');
			   });
			
			 } else if (result.isDismissed) {
			   // ⬅️ Jika batal pada jumlah tim
			   startButtonContainer.classList.remove('d-none');
			 }
			}).catch(() => {
			 startButtonContainer.classList.remove('d-none');
			});
			});
			
			printButton.addEventListener('click', () => {
			const printWindow = window.open('', '_blank');
			if (!printWindow) {
			    Swal.fire('Error', 'Gagal membuka jendela cetak. Pastikan popup tidak diblokir oleh browser.', 'error');
			    return;
			}
			printWindow.document.write(`<html><head><title>Daftar Tim</title><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous"><link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet"><style>body{font-family:'Poppins',sans-serif;padding:20px;background:linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%);}.card{margin-bottom:20px;border:2px solid #0d6efd;border-radius:10px;background:rgba(255,255,255,0.9);}h1{text-align:center;color:#0d6efd;margin-bottom:30px;}.footer{text-align:center;margin-top:20px;color:#333;}</style></head><body><h1>Daftar Tim</h1><div class="container"><div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">${resultDiv.innerHTML}</div></div><p class="footer">Powered by D.A.M.Z</p></body></html>`);
			printWindow.document.close();
			printWindow.print();
			});
			reshuffleButton.addEventListener('click', () => {
			loader.style.display = 'block';
			setTimeout(displayTeams, 1000);
			});
			resetButton.addEventListener('click', () => {
			resultDiv.classList.add('d-none');
			actionButtons.classList.add('d-none');
			startButtonContainer.classList.remove('d-none');
			}); 
		</script>
	</body>
</html>